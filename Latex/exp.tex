\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath} % Advanced math typesetting
\usepackage[utf8]{inputenc} % Unicode support (Umlauts etc.)
\usepackage[ngerman]{babel} % Change hyphenation rules
\usepackage{hyperref} % Add a link to your document
\usepackage[final]{graphicx} % Add pictures to your document
\usepackage{listings} % Source code formatting and highlighting
\usepackage{bookmark}
\usepackage{natbib}
\usepackage{geometry}
\usepackage{multicol}
\usepackage{fancyhdr}
\usepackage[document]{ragged2e}
 
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{Overleaf}
\fancyhead[RE,LO]{Guides and tutorials}
\fancyfoot[CE,CO]{\leftmark}
\fancyfoot[LE,RO]{\thepage}
\graphicspath{{Immagini//}}
%C:\Users\erikz\OneDrive\Desktop\PaioPaio2\IMM-Sensors-Network\Latex\Immagini
\geometry{
 a4paper,
 total={170mm,257mm},
 left=20mm,
 top=20mm,
 }

\title{Imm algorithm implementation for tracking}
\author{
Paiola Lorenzo 198573 

Zanolli Erik 198852}
\date{January 2020}





\begin{document}

\maketitle



\section*{Introduction}
\justify
The purpouse of this project is to analyze and evaluate the performance of an IMM algorithm's implementation in a distributed environment for
agent's tracking. The agent switches between linked models of movement by the means of a Markov chain. The goal is evaluate the best trade-off
between error on estimated position and real position and number of messagesses involved in the tracking.

\begin{multicols}{2}
    \section*{Setting}
    \justify
    NON CAPISCO COSA VUOI DIRE, IN QUALSIASI CASO QUA AGGIUNGI CHE PARLIAMO DI FILTRI DA DISCRETE-DISCRETE
    \\
    Tracking an object with a switching dynamic require proper algorithms and filters.Retriving physical data with
    observations it's not enough in the case of Markov processes that switch between modes and we need to
    , models achiving the best-fit to our data is needed in order to make a prediction and estimate
    with reduced uncertainty. Here comes to play a major role the IMM algorithm (Interacting Multiple Models): The data
    from sensor are combined with different dynamical models through the algorithm...
    \subsection*{Sensor's model}
    The sensors chosen are radars measuring the relative polar cordinates at which the agent is collocated at the timestep, and
    are disposed as a uniform grid. In order to simulate the real workings of a sensor, we have limited the range of measurement to the distance
    between one sensor and the following one in any direction of the grid, as soon as the agent exceed the imposed maxiumum distance from the sensor,
    the device will stop sensing.
    This property of the sensor grid, coupled by its geometry, ensures that no more than 4 sensors can measure the agent position at the time,
    so it made sense to let sensor switch between 3 different states that we named ON, OFF and IDLE. This can be justified as a way to make the system
    more power efficient and to avoid useless data stream towards sensors that aren't currently in range and sensing.
    The sensor is modeled as a state machine as shown.
    \\
    AGGIUSTA FIGURA CHE E' SBAGLIATA E NON CI SONO GLI INRANGE, I CANSENSE/CANNOT SONO I SEGNALI MANDATI, NON LE ROBE CHE FANNO CAMBIARE STATO 
    \begin{figure}[h!]
        \centering
        \includegraphics[scale=0.05]{UntitledDiagram.png}
        \caption{State machine sensor}
        \label{fig:galaxy}
    \end{figure}
    \\
    TABELLA CON LE FUNZIONI DEGLI STATI (mettere di fianco al paragrafo sotto una immagine che fa  vederecosa intendiamo con neighboors (gli 8 
    sensori circostanti))
    \\
    Sensors can communicate with the devices adjacent to them (Neighboorhood) and exchange with them signals named CanSense and CantSense
    which state respectively whenever the agent gets in or goes out of the communicating sensor's range. This check is done through the 
    function inRange() that also serves as a switch between the states of the sensor, as already shown by the figure above.
    \\
    QUESTO METTILO NEL CONSENSUS, NON HA SENSO PARLARNE QUI
    \\
    The set of active sensors inside the grid is dynamic, as vertices keep getting added and popped. However it has to be noticed, as stated before, that no 
    more than 4 sensors will be ON at any point of time and they will all be adjacent to each other, this let us model the graph of the active 
    sensors as fully-connected, since the distance between them is short and they are directly linked.
    \\
    Different state can receive and send different messagesses. A sensor in On state has the moving
    object in his range and send a CanSense to the nearby and when trackin moving away from the operating range send a CantSense turning itself to Idle.
    Sensors that receive a CanSense and are not already On turn in Idle state; during the Idle state sensors check
    if object appears in range sensors turn to On and send a CanSense, if nothing trigger the range it send to the nearby a CantSense signal.
    A sensor that is in Idle and during the information exchange receive only CantSense from the nearby turn itself Off and stop to check if somenthing is in range and
    can be turned again to Idle via a CanSense. This scheme implies that a sensors can never switch to On from Off except for the initialization step.
    \\
    When a sensor have the target in range it does a measure operation each timestep. the sensor works a radar in this model and remembering
    \begin{equation}
        z(k)=h(x(k))+v(k)
    \end{equation}
    where $h(x)$ is the polar to cartesian cordinates transfor
    \begin{equation*}
        \begin{bmatrix}
            \rho\\ \alpha
        \end{bmatrix}=
    \end{equation*}
    where the \textbf{H} is
    \begin{equation}
        H= \begin{bmatrix}
            \frac{x}{(x^{2}+y^{2})^{1/2}} & \frac{y}{(x^{2}+y^{2})^{1/2}}& 0& 0 \\
            \frac{-y}{(x^{2}+y^{2})}  & \frac{x}{(x^{2}+y^{2})}& 0& 0 \\
        \end{bmatrix}
    \end{equation}
    \subsection*{Imm and Linear Consensu}
    The IMM algorithm is based on the

    \section*{Model used}
    Introduction

    \subsection*{Random walk and Unycicle model}
    The target in this simulation can move accordingly to two families of models, both are Markov processes.
    \\
    TABELLA CON DA UNA PARTE LE MODES DI UNO E DELL'ALTRO AL POSTO DI SPIEGARLO A PAROLE
    \\
    
    In the case of the random walk we choosen to have 5 states: costant velocity, positive or negative acceleration
    on x direction and positive or negative deceleration on y direction. The Transition matrix 
    associated with the Markov's chain is shown below
    \begin{equation*}
        \begin{bmatrix}
            0.8 & 0.025 & 0.025 & 0.025 & 0.025 //
        \end{bmatrix}
    \end{equation*}
    The linear system describing the evolution of the state is 
    \begin{equation}
        x(k+1)= Ax(k) + B(s)u(k) + Gw(k)
    \end{equation}
    Where $x(k)$ is the state at the current timestep, $u(t)$ is the input and $w(k)$ is the process noise.
    In this case the state is a vector of the cartesian cordinates and their relative speed, while the input 
    is the acceleration which the noise will influence. 
    State,state and noise matrix associate to the random walk has shown below:
    \[ x=\begin{bmatrix} x \\ y \\ \dot{x} \\ \dot{y} \\ \end{bmatrix}  A=\begin{bmatrix}
            1 & 0 & \delta & 0      \\
            0 & 1 & 0      & \delta \\
            0 & 0 & 1      & 0      \\
            0 & 0 & 0      & 1      \\
        \end{bmatrix}
        G=\begin{bmatrix}
            \delta^2/2 & 0          \\
            0          & \delta^2/2 \\
            \delta     & 0          \\
            0          & \delta     \\
        \end{bmatrix}
    \]
    With $\delta$ time step of the simulation.
    \\
    We hypothesize that the input is unknown in direction but known in magnitude. This set according to the current state at which the markov process is at the timestep.
    This is modeled though the switch between a set of matrices $B(s)$ that change according to the chain's state $s$.
    \[
        B(s)=\begin{Bmatrix}
            \begin{bmatrix}
                0 & 0 \\
                0          & 0 \\
                0     & 0 \\
                0          & 0 \\
            \end{bmatrix}
            \begin{bmatrix}
                \delta^2/2 & 0 \\
                0          & 0 \\
                \delta     & 0 \\
                0          & 0 \\
            \end{bmatrix}
            \begin{bmatrix}
                -\delta^2/2 & 0 \\
                0          & 0 \\
                -\delta     & 0 \\
                0          & 0 \\
            \end{bmatrix}
            \begin{bmatrix}
                0 & 0          \\
                0 & \delta^2/2 \\
                0 & 0          \\
                0 & \delta     \\
            \end{bmatrix}
            \begin{bmatrix}
                0 & 0          \\
                0 & -\delta^2/2 \\
                0 & 0          \\
                0 & -\delta     \\
            \end{bmatrix}
        \end{Bmatrix}
    \]
    It can be noticed that the matrix $G$ is a merge between the second and the fourth matrices found in the set $B(s)$ as the noise will act
    randomly in direction and magnitude at every time-step.

    The unycicle model has different input and state description. The inputare represente by the angular acceleration of the wheel and the steering angle acceleration.
    possible state are 5: constant angular velocity, acceleration and deceleration of the wheel and positice or negative acceleration of the steering angle.
    The associate Markov chain for this case is
    $$\begin{vmatrix}
            0.8 & 0.025 & 0.025 & 0.025 & 0.025 //
        \end{vmatrix}$$
    Unycicle model instead is a Non-linear model. Thus is necessary to use a linearization in the Kalman filter implementation
    The matrix that represent the state of system for this case are
    \[ X=\begin{bmatrix} x \\ y \\ \dot{x} \\ \dot{y} \\ \end{bmatrix}  A=\begin{bmatrix}
            1 & 0 & \delta & 0      \\
            0 & 1 & 0      & \delta \\
            0 & 0 & 1      & 0      \\
            0 & 0 & 0      & 1      \\
        \end{bmatrix}
        G=\begin{bmatrix}
            \delta^2/2 & 0          \\
            0          & \delta^2/2 \\
            \delta     & 0          \\
            0          & \delta     \\
        \end{bmatrix}
    \]
    \subsection*{Data's simulation}

    \section*{Result}
    The performance evaluation of the system are evaluted by computing the RMS of the predicted trajectory eith the respect to the actual one
    choosing different rate of performind the WSL. The final result are listed in the table below


    \begin{center}
        \begin{tabular}{||c c c c||}
            \hline
            1 step & 2 step & 3 step & 4 step \\ [0.5ex]
            \hline\hline
            1      & 6      & 87837  & 787    \\
            \hline
            2      & 7      & 78     & 5415   \\
            \hline
            3      & 545    & 778    & 7507   \\
            \hline
            4      & 545    & 18744  & 7560   \\
            \hline
            5      & 88     & 788    & 6344   \\ [1ex]
            \hline
        \end{tabular}
    \end{center}


    \subsection*{}
\end{multicols}
\end{document}
